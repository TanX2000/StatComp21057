<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tan Xin" />

<meta name="date" content="2021-12-20" />

<title>Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Tan Xin</h4>
<h4 class="date">2021-12-20</h4>



<div id="section" class="section level1">
<h1>9-16</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<ul>
<li>Use knitr to produce at least 3 examples (texts, figures, tables)</li>
</ul>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<ul>
<li>(1)tables:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">1</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(x)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
<ul>
<li>(2)figures:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>(3)texts:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(y)</span></code></pre></div>
<p>y的最大值为1.</p>
</div>
</div>
<div id="section-1" class="section level1">
<h1>9-23</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</li>
</ul>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section-2" class="section level3">
<h3>3.4:</h3>
<p>由于<span class="math inline">\(f(x)\)</span>形式已知，可以考虑用逆变换法生成随机数。 由<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\geqslant0\)</span>，知: <span class="math display">\[
F(x)=\int_{0}^{x}f(t)\mbox{dt}=1-e^{-x^2/(2\sigma^2)}
\]</span> 于是<span class="math inline">\(F(x)\)</span>的逆<span class="math inline">\(F^{-1}(y)\)</span>可计算如下： <span class="math display">\[
F^{-1}(y)=\sigma \sqrt{-2\ln(1-y)}
\]</span> 在生成随机数过程中，我们分别将<span class="math inline">\(\sigma=1\)</span>取为<span class="math inline">\(0.2,1,5,20,50,100\)</span>。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e3</span> <span class="co">#每次生成1000个数据</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n) <span class="co">#生成U~U(0,1)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>sigma[i]<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="co">#按sigma从小到大的顺序依次利用F(x)的逆生成X</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  upper<span class="ot">&lt;-</span><span class="fu">floor</span>(<span class="fu">max</span>(x))<span class="sc">+</span><span class="dv">1</span> <span class="co">#找到生成的X的上界，为方便f(x)实际密度函数作图</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span>upper,<span class="at">by=</span>upper<span class="sc">/</span>n) </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">15</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(t,t<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">*</span>t<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma[i]<span class="sc">/</span>sigma[i])<span class="sc">/</span>sigma[i]<span class="sc">/</span>sigma[i],<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)<span class="co">#在直方图中作出f(x)实际的密度函数曲线作为对比</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从随机数频率直方图与<span class="math inline">\(f(x)\)</span>的实际密度函数曲线的对比中可以看出，在不同的<span class="math inline">\(\sigma\)</span>值下，二者的吻合程度均很高，这说明可以认为随机数是服从Rayleigh分布的。</p>
</div>
<div id="section-3" class="section level3">
<h3>3.11:</h3>
<p>先生成<span class="math inline">\(p_1=0.75\)</span>时的随机数:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>)) <span class="co">#按0.25与0.75的概率比生成0-1分布</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> r<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>X2 <span class="co">#r有0.75的可能取1，于是Z有0.75的可能取X1</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z,<span class="at">prob=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从<span class="math inline">\(0.3-0.7\)</span>，每间隔<span class="math inline">\(0.05\)</span>作为一次<span class="math inline">\(p\)</span>的取值，通过对比它们的直方图比较双峰性的显著与否。</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">seq</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>,<span class="fl">0.05</span>) <span class="co">#从0.3至0.7每间隔0.05作一次p的取值</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(3,3)) #生成3x3直方图,从左至右、从上到下p值依次增大0.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p)){</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p[i],<span class="dv">1</span><span class="sc">-</span>p[i]))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> r<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>X2</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(Z,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///9Gpd91AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIqElEQVR4nO2da0PbNgBFTQcjo3uQ0a1N9+gw29jqli4G4v//z2ZJduIES1eO5FiS7/kAIZFk+6CXJUXOKmIkm/oEQoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCjC5os8ou1ur35faPzsd//uv7gHeLLPtevHpeZg3vjk9uYkFPN698CyqFkWvxKkJBL8gz74KK7OxWvYpQUPPHp6ssO/vuXvipEYoe3mTZVz/JzLW5y7LzW2muvtbfb7JX99XDTR3u9a285suHq+zsbfVpUYfaHWabgEzyrPNJmTn9E6YQVKh/a33araDmHRGwDiKu8Gr39sW6VB/Xl73NFFetWsUugUNBj4s9XYM5haCWRpDIBevqs6woVBGrL0J5u5b/8Mv1Jm+9XdxX/9Wxvl6LQNdS0LWIm71twku6CRR7QupPXArYJILqcz7/u/lUCWpqolxlKvG6FqEEtRf35a8rkUD9fm1C/ZTGuslUbbncCVJCXZhAkHpH1TjyktpSKC6tfb13rZtf2gRE7quanztB3QT2BIlD9TQNQ5iiDnq6UVXKH40Hdb2ydL1rX3cFics8/+3LUiuom8CeoDw77HcNZpp+0NOvV22VapGDlIlnvSBdDircGjDJZB3FzftdjaOvg+S1yoyxraR7BGnqoDJza8AkEwiqz/sHWc5kwyMuQd+KtTnoYv200tdB/a3YXu13NFPkoLttt0beF5j6Qds6yFhJd/tBKQiqPosa6PV91XSb75uO8M8qQv3Wt/cvWrHzD0X9lk5QJ4HYBB1J7tz8eCI4Qbkcq6hzh2P/xRfBCWruuzy0P34ITlD19GbR3OsHQXiCAoOCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYBhgtphXu9rVsJlkKCiHSUvHSe8I2KIoM1qN80SyJD6+AwR9LzcLiQpZ1PImIMAA+ugJguxDtLQroCbTf5hPwhCQYBhgop2zXHBVqyPQi7EFZPmFNSHauY3K7FWiYJ6aDuK+cWagvrYdhTzSwrqpdWillh2U9ni8dTCYGgrpgrZZqXJQXMXdOrkTEfaZ7zjBJ2c6UgfuwQnSFdJU9BpkzMdiYLAkSgIHClIQXBWY+aC8KzGmIIOGvYABVmMSY8qaF9JgIIsZjXmLYg5CIFnNWYuCM9qzF3Q2MkdNFT7qVHQoYOPFPQiOgWB6BQEolMQiE5BIDoFgegUBKJTEIhOQS8iGAZ5KKgyX3VCgo6fwItHULvNlafkrCNEI0gtH3NdvJq0oMqDo9QFKUUOa38SF1TKNZpyjZ2P5KwixCNIDKcqMw5fxEhY0PPSx5ZGKQv6Uflx+x6PZ0GmudSpBLktz/QsyP4vh3MGJ6h+5bv/U0jNfDiCdjnIU3LWEaIRZIX/5S9pCRph+Uskgp6X19vd4vWV9BiLFyIRZMcYy1+SEjTzHFQXM/kYAsN92AjLXyISlIvnFVxWuWnYzP/yl3gEiQqmrHNIULcaoQnKxSbXFLR/gttX+eXzUjw2xWlkOmVBdf0intrgNnKfsiDM7nFU2u7kvAXpv2h4XHIyQjyCbHaXgiUwZUG5TfNV9j+LaqyZ1ZAEiY60x+SsI0QkyOk5ZYfJWUeIRpBrA3+QnHWEaATpqpd+vH2pNx5BFgNmQ5KzjhCNoImSoyAUISJB8tmTubGxn/WsRnl2W4i7eYOh+c5qVGrAuTDvLTXvMWnRURSXbRhRnPesRpuDcv2o/bxzUFMHFabu4rxnNVRX0byKKtxZDcN3Xd04fT/IflXUEEGj5acJBFlfZ1iCVOk5waOjIxWUN3u0jv909jgFlW3l/LhwGjdLVVBntMw4N2+ZnDlIjII6d2CjTz1HKsjT8w4oyCo5cxAKAkEoCASJUxBclmBOZcBdUJSCTpkcBaEgFASCUBAIQkEgCAWBIBQEglAQCEJBIAgFgSAUBIKkLMjH6o6UBXlZ3ZGwID9z8wkL8rO6I2FBzEEIL6s7UhbkZXVH0oJ8JEdBKEjKgthRNHNkR3HARlKeBHlccHaKZv7Y6zxe0EEyw5RYXJGGYzuKsxFknYMOs/hcBOk7igfF/VBQWIwoCHcU02O8FdiJQEGAIwXxaeFuiQaG07X4kmKdqOnD00eEUBDA882qRaIpC8I3qxaJJizI4lbDItGEBVmvhZ2rIOYgBJ7VsEg0ZUG2N6vzFTRDKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEGAsQdqt0OSwdu9gSWnY/0ofCxyuelxkTk/YHUlQqRsR2axqCUXfKYsNaEqNIX0scLiqrD9wetLDOILkpp69n6jtd3omZtVwpWbvGW0sdDiVqss88DiCiov3xjG1npwCHGhiocM9fuP63L1RBNWnZdiOserdP19dinEyQLfrvuFw5at/lm6PbRxDkMjXRkF9Q9oqe2gziSYWOlwh5jidNlsfQxDY0LO+Uk0dbRTUGwsdrjiD+RIwgiBZWAyC+nMCKmLaiRTj4VSd5rIxm19B8nHsRbPo5PCkmme1azbaA5W0fns+3eEkSrhLVX3yjqJus1hjM6+NhQ6nJoMDK2IS3Rk/LnQ5wdRR1McCh5MVVGdGeDinFtQUiD4Rhf5WwxDLfDh5AxNcM58UFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEDggtpvEbs9mtKFwAUpCvPzg0clBkFw8cuYRCBos5pyT7kIBE1ZwGIQNGkBi0DQtAUsAkHTFrDwBTl9U8cHoQvSfT/jZAQuqATro8cncEF5s4x+unIWuKDpoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DVyX8b0V6VMQAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>从<span class="math inline">\(p=0.3,0.35,...,0.65,0.7\)</span>生成的混合正态随机数直方图可以看出：当<span class="math inline">\(p\)</span>接近<span class="math inline">\(0.5\)</span>，尤其在<span class="math inline">\(0.45-0.55\)</span>区间时，双峰效应十分显著；当<span class="math inline">\(p\leqslant0.35\)</span>或<span class="math inline">\(p\geqslant0.65\)</span>时,双峰性较为微弱。</p>
</div>
<div id="section-4" class="section level3">
<h3>3.20:</h3>
<p>本题中，设<span class="math inline">\(Y_i\sim \Gamma(a,b)\)</span>，于是<span class="math inline">\(X(t)\)</span>的理论期望及方差： <span class="math display">\[
E[X(t)]=\lambda t E[Y_1]=\frac{a\lambda t}{b}
\]</span> <span class="math display">\[
Var[X(t)]=\lambda tE[Y_1^2]=\lambda t
(E^2[Y_1]+Var[Y_1])=\frac{(a^2+a)\lambda t}{b^2}
\]</span> 我们分别对<span class="math inline">\((1)\lambda=a=b=1,(2)\lambda=1,a=2,b=5,(3)\lambda=5,a=b=1,(4)\lambda=5,a=2,b=5\)</span>四种参数情形进行随机数生成。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>estimate_mean<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>estimate_var<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>theory_mean<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>theory_var<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    T <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">200</span>, lambda[i])  <span class="co">#interarrival times</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    S <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(T)  <span class="co">#arrival times：cumsum计算累积和S[n]=T[1]+T[2]+...+T[n]</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(S <span class="sc">&gt;</span> t0)) <span class="co">#arrivals+1 in [0, t0]： N(t0)为落在[0,t0]区间的次数，故先找到使得S[n]最先超过t0的n，将其-1即为所求</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(n<span class="dv">-1</span>,a[i],b[i]) <span class="co">#生成N(t)个服从Gamma(a,b)的Y</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(Y) <span class="co">#X(t)的取值为这N(t)个Y的总和</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  estimate_mean[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(X) <span class="co">#计算均值的估计值</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  estimate_var[i]<span class="ot">&lt;-</span><span class="fu">var</span>(X) <span class="co">#计算方差的估计值</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  theory_mean[i]<span class="ot">&lt;-</span>lambda[i]<span class="sc">*</span>t0<span class="sc">*</span>a[i]<span class="sc">/</span>b[i] <span class="co">#计算均值的理论值</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  theory_var[i]<span class="ot">&lt;-</span>lambda[i]<span class="sc">*</span>t0<span class="sc">*</span>((a[i]<span class="sc">+</span>a[i]<span class="sc">*</span>a[i])<span class="sc">/</span>(b[i]<span class="sc">*</span>b[i])) <span class="co">#计算方差的理论值</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>parameters<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;(1,1,1)&#39;</span>,<span class="st">&#39;(1,2,5)&#39;</span>,<span class="st">&#39;(5,1,1)&#39;</span>,<span class="st">&#39;(5,2,5)&#39;</span>) <span class="co">#按lambda,a,b的顺序</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">cbind</span>(parameters,estimate_mean,theory_mean)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1,<span class="at">align=</span><span class="st">&#39;l&#39;</span>) <span class="co">#生成期望估计值与理论值的比较表格</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">parameters</th>
<th align="left">estimate_mean</th>
<th align="left">theory_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(1,1,1)</td>
<td align="left">10.0128846990827</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">(1,2,5)</td>
<td align="left">3.99231918447474</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">(5,1,1)</td>
<td align="left">50.0323454154176</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">(5,2,5)</td>
<td align="left">19.9926900082647</td>
<td align="left">20</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">cbind</span>(parameters,estimate_var,theory_var)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2,<span class="at">align=</span><span class="st">&#39;l&#39;</span>) <span class="co">#生成期望估计值与理论值的比较表格</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">parameters</th>
<th align="left">estimate_var</th>
<th align="left">theory_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(1,1,1)</td>
<td align="left">20.4601371917459</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">(1,2,5)</td>
<td align="left">2.42774211220883</td>
<td align="left">2.4</td>
</tr>
<tr class="odd">
<td align="left">(5,1,1)</td>
<td align="left">99.5773259565704</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left">(5,2,5)</td>
<td align="left">12.0225568076161</td>
<td align="left">12</td>
</tr>
</tbody>
</table>
<p>从<span class="math inline">\(X(t)\)</span>期望和方差的估计值与理论值的对比可以看出，在不同参数取值时，二者均十分接近；当试验次数从10000进一步增加时,最终结果应当会更为接近理论值。</p>
</div>
</div>
</div>
<div id="section-5" class="section level1">
<h1>9-30</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</li>
</ul>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-6" class="section level3">
<h3>5.4:</h3>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) for x = 0.1, 0.2,…, 0.9. Compare the estimates with the values returned by the pbeta function in R.</p>
<p><span class="math inline">\(\textbf{解：}\)</span> 运用简单Monte-Carlo方法。对于beta(3,3)在[0,p]上的积分，生成服从[0,p]上均匀分布的随机数，再代入<span class="math inline">\(g(x)\)</span>计算近似积分。 <span class="math display">\[
f(x)=\frac{x^2(1-x)^2}{B(3,3)},\quad g(x)=pf(x)=\frac{px^2(1-x)^2}{B(3,3)},\quad \mbox{其中}B(3,3)=\int_{0}^{1} x^2(1-x)^2 \mbox{dx}
\]</span> <span class="math inline">\(E[g(X)](X\sim U[0,p])\)</span>用下式进行近似： <span class="math display">\[
\frac{1}{n}\sum_{i=1}^{n}g(X_i),\quad X_i(i.i.d)\sim U[0,p]
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(p))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(p))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p)){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">504</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,p[i])</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(p[i]<span class="sc">*</span><span class="fu">mean</span>(u<span class="sc">*</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)),<span class="dv">4</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">pbeta</span>(p[i],<span class="dv">3</span>,<span class="dv">3</span>),<span class="dv">4</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>table5_4<span class="ot">=</span><span class="fu">cbind</span>(p,theta,theta.hat)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table5_4,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">p</th>
<th align="center">theta</th>
<th align="center">theta.hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.1</td>
<td align="center">0.0086</td>
<td align="center">0.0085</td>
</tr>
<tr class="even">
<td align="center">0.2</td>
<td align="center">0.0579</td>
<td align="center">0.0576</td>
</tr>
<tr class="odd">
<td align="center">0.3</td>
<td align="center">0.1631</td>
<td align="center">0.1623</td>
</tr>
<tr class="even">
<td align="center">0.4</td>
<td align="center">0.3174</td>
<td align="center">0.3160</td>
</tr>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">0.5000</td>
<td align="center">0.4980</td>
</tr>
<tr class="even">
<td align="center">0.6</td>
<td align="center">0.6826</td>
<td align="center">0.6802</td>
</tr>
<tr class="odd">
<td align="center">0.7</td>
<td align="center">0.8369</td>
<td align="center">0.8347</td>
</tr>
<tr class="even">
<td align="center">0.8</td>
<td align="center">0.9421</td>
<td align="center">0.9403</td>
</tr>
<tr class="odd">
<td align="center">0.9</td>
<td align="center">0.9914</td>
<td align="center">0.9905</td>
</tr>
</tbody>
</table>
<p>从与真实值的对比结果可以看出，准确程度还是不错的。</p>
</div>
<div id="section-7" class="section level3">
<h3>5.9</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x) = \frac{x}{σ^2} e^{−x^2/(2σ^2)}, x ≥ 0,σ&gt; 0.\)</span> Implement a function to generate samples from a Rayleigh(σ) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with<span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
<p><span class="math inline">\(\textbf{解：}\)</span> 密度函数<span class="math inline">\(f(x)=\frac{x}{\sigma^2}exp\{ -\frac{x^2}{2\sigma^2} \}\)</span>，故分布函数： <span class="math display">\[
F(x)=\int_{0}^{x}f(t)\mbox{dt}=1- \exp \{ -\frac{x^2}{2\sigma^2} \}
\]</span> 于是<span class="math inline">\(F(x)\)</span>的逆<span class="math inline">\(F^{-1}(y)\)</span>可计算如下： <span class="math display">\[
F^{-1}(y)=\sigma \sqrt{-2\ln(1-y)}
\]</span> 生成<span class="math inline">\(U\sim U[0,1]\)</span>后，<span class="math inline">\(X=\sigma \sqrt{-2\ln(1-u)}\)</span>。运用对偶变量法，由于<span class="math inline">\(1-U\sim U[0,1]\)</span>，可令<span class="math inline">\(X’=\sigma \sqrt{-2\ln [1-(1-U)]}=\sigma \sqrt{-2\ln U}\)</span>。本题中，我们选用<span class="math inline">\(\sigma=1\)</span>进行计算。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>u1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>) <span class="co">#生成U(0,1)上随机数</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u1))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>x1_new<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u1)) <span class="co">#用X1生成其对偶变量X1&#39;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>u2<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u2))  <span class="co">#生成新变量X2</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>((x1<span class="sc">+</span>x1_new)<span class="sc">/</span><span class="dv">2</span>),<span class="fu">mean</span>((x1<span class="sc">+</span>x2)<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.252383 1.261319</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>var_anti<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">var</span>((x1<span class="sc">+</span>x1_new)<span class="sc">/</span><span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>var_ordinary<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">var</span>((x1<span class="sc">+</span>x2)<span class="sc">/</span><span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>var_reduction<span class="ot">&lt;-</span><span class="fu">round</span>((var_ordinary<span class="sc">-</span>var_anti)<span class="sc">/</span>var_ordinary,<span class="dv">4</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>table5_9<span class="ot">&lt;-</span><span class="fu">cbind</span>(var_anti,var_ordinary,var_reduction)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table5_9,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">var_anti</th>
<th align="center">var_ordinary</th>
<th align="center">var_reduction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.0112</td>
<td align="center">0.2158</td>
<td align="center">0.9481</td>
</tr>
</tbody>
</table>
<p>方差减少百分比为94.81%，说明对偶变量法能够实现方差的缩减。</p>
</div>
<div id="section-8" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞) and are ‘close’ to <span class="math inline">\(g(x) = \frac{x^2}{\sqrt{2π}} e^{−x^2/2}, x&gt; 1.\)</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2π}} e^{−x^2/2} dx\)</span> by importance sampling? Explain.</p>
<p><span class="math inline">\(\textbf{解：}\)</span> 这里两个重要函数我们可以选用如下： <span class="math display">\[
f_1(x)=x \exp \{-\frac{x^2}{2}\},\quad f_2(x)=\frac{1}{\sqrt{2\pi}} \exp\{ - \frac{x^2}{2} \}
\]</span> <span class="math inline">\(f_1(x)\)</span>即为<span class="math inline">\(\sigma=1\)</span>时Rayleigh分布的密度函数，服从该分布的随机数可通过逆变换法生成；<span class="math inline">\(f_2(x)\)</span>为正态分布的密度函数。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="do">##生成g,f1,f2的图线</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,g,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f2,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">##生成g/f1,g/f2的图线</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">130</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZmY6ZpA6ZrY6kNth0E9mAABmADpmAGZmOjpmOmZmOpBmZmZmZpBmZrZmkLZmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkLaQtv+Q2/+2ZgC2Zjq2kJC22/+2/7a2///bkDrbkJDbtmbbtpDb/9vb///fU2v/tmb/25D/27b//7b//9v///8IP7B2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJR0lEQVR4nO2de3+bNhSGSZd467olbtem6+bdV3pjW1Mc8Pf/ZEM6mIuN9YqLkLDf54/87ECI9Vg3OOIQ7YiRyPcHCB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIEKygbH31dpdEwtV3H3a77erJp/k/R7CCkuj6oRIURYWbfBPdzv85QhUkNmpB8q5wNjehCkqjooUVSqRVbVfRjf758+wfJFRBomYv6L+VqkHZ2kMbC1RQ0cKKKtNoYrpxxR7aWKCCisrSEnT1k/ptHM0/jgUqaKvb1EEnXbxVHdO8hC5IqszjuuySKKjkQFCphoIqDmvQhoLaHHbSMoyxk644GuZ11eEwXyOnFZWgp8XJqp+TsVAFpR3dzXY1fxcUrKCithydd6U8WW2Q6E6oRczLHQ2y9eGIxQtmQUJBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCTCwoWgy+BE17OHd4E7QM/AlaBhQEoCAABQEoCEBBAAoCUBCAggDzC2pMUZcAaxCAggAUBKAgAAUBLkRQ/vuzv+VV30JciKDkbf6r3B9FQSfIXuk7EHuX4VIE5b/ILayRuoHz+AbF01yIoOzlB3kR7ZKbwpF9bqGzFxRfP+Sb23fP7l+rJlYWIbG/ofXsBe3i27huUVKE7IX9Da3LEZS/35fq8Y3NHd+qr1FZKvJN4wZxXYTseY9b6hcj6PF1Xczsvsctzc0UA7oE26/7pBwIWlASVXe/Zy+bTrbfWmcNKDrktKpCqgTbb3rdMO7xetCXDlp7Zuu6L43bI3NsO1Dnm5vG3qoEsfrfi+ikLQRVo/F21R6Y00GZOYYUIOAmtl1FVQ6gRL9QP6VaNSvXnmprcqqKnJmgRg0qR6JiQrNLylfHuUv2W5Oidm1XU6XuWIagbC0+0icfZYjONx25OWSrVK50qtwdyxC0XZXdbFyeRuUb6YTissO/qbdK93TYaQ0mfEFq2lsJSstMQXtBbfTWtHR2KYJ06pt9E8s399J0OpuYbB02wJ3EnSCZ6kcjktEpQfmvH198qvrk5Prz5lYOLr9oNTHZ2pgcTIEzQcl+pE0H54Kqm1g5zKtfpOWr44Put6pRbBdPVY9cCco3VQmSodnEGoKkz42LI+mpcWc7qrYmo+rtAa4ENSr6yBFXrk0MPdUYTcg1SBBB2Q/NKrN9OluGMod9UFmFhvdBQnl1q3k6n/8xXwY3d6NYtpYBZqp8hvn78rLy7vGvGVMkhjwPCoJzXx80PKS6q/7MkaBiDnejJ4vzP76hwfCQaom7Trroe/TJY9ecbk6GhlRLnA7zMp0bOcyPpA6pnuLkTSz7v3M3UZQp4mSXZobQCKmeijmbi3XuNagRUm3HnOvC+BFU90GNOfWsSMx5/+4o5hwdvehmOaNY38iqOeZsW4GWM1G0j6x2xZxLP3XM+TwEjYusGmPObUHaaXdP4F/QXcnxlnGRVXPMuSVIX+HuyPtebvYr6M4kaERktRVz1p+8GXNuFCXaHz3pnI54F3SavpHVPiHVri6oW3rAgvpGVvuEVLsExYX+f1d6Fn3V6qwWIMgqstojpFqWpHVTvLqwt33z+c+H9vqzZQiyiqz2CKnqkhR6GqVP5ch5IejVQ3vXYK8HdQgyRVZ7hFQb0+ho/8fSNLMfD+YQodcgOcO0iqz2CKkeCaqieNvvFyZIzjCtIqv2IdVGF733s//T9HZhghTFGaZNZNU+pBodvKyHPnW6X0wo//nU3CF0QbK8A0dW7UOqh4LKR5MVx9T63zUnUyELEuQMc9LIap+CBC+oPMOcMrLaqxyhC6rOMCeMrAYiaPz6IEV9hnlukdUJ1gcFgdOL9oLfsM9YnIZ9BK9hn9GwBgEc9kETrQ/yjLtRDK4POhHyDQ1/86AZplUdF7oH4Ot6kHNBnZGAATgVZLjAN4OgaY7jaJiva8qJYd6poKnkKNzUoHLw8lSDpmpdGmejmBq/fDaxqXDWB8U6TjW7oCkrj8ZdJ12csM4vaNLWpXE4im1XX7GJGck3p8NU0wuavO4IZzOTnr5xCWchyI0a4QwEuao7wlkImu5YxyxckFs5imULctu6NMsWNANLvR7kvuqULLUGUdBJZlMjUBBgUYJmdqNZkqAZBvVjFiLIhxphGYK81B0hdEH+zJSEK0jUUNApPLaqFgEK8mrmKCOorzWKnYebulUd5kC1fI8/aBcTr1FsH25vpkvNgBJ+ab/7suvx3vxBDUy8wqw83N2d+lC1GfN32rfEUzDzGsWDyx13IqjfdzovnmtQ+Phao3jhgizWKPY6nEcCnAeFhTdBi8GToBH/Bu8yyUH6lpiCpt19KBQ0/t9Q0OhdKGiOg1DQBLuM2H0oFDT+31y2oOVCQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCADMIMqQGbxKbM+6oRMsgTZ7KDGjMS1kmT0tbqYEB7gWZUoM3SM2PnFKJyLO18SAqJ2VqMqSfPSn5Gu1ToLoXZEoNXpOtjYJk3YTxIJKt0pCMMZWFX3Io66SNc/VB6CtLrn8zCbJ4njwSlEa3etGO3RdWMZeg2PyBCgHGPih98nGNOjLYxGRVk7i2TsI2kyCQ00tVe6OgRLUOqSOmfwI6X21F6rJ1JzSPoBT00fqZOEZBV/hrV5XUnP4+WEEoJ5yu9WZBWo0xdbtF3xJqE0vQLKhMbWzoP6Q8xq7aomYE2kkndo9KMtYgWT9q/Nql4MZd0iCHecunYoCZdKLzchuPZNkHBTdRrFODmwGnGik+X4nRLmX1SsI61Vg4FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA0AWplWDZ2uNTXUMXpBZNeX0scOiC1Arp59arnRwQvKBdDG/zcEr4gsyL550TvKB8c+/10e3BC0quP5sXtzomdEFqgbT1qngXhC4o1uujPXbToQvyDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgfkJj9QAMoXfcAAAAASUVORK5CYII=" /><!-- --></p>
<p>通过图(A)(B)，<span class="math inline">\(g/f_1\)</span>相比<span class="math inline">\(g/f_2\)</span>变化幅度更小，故可推测通过<span class="math inline">\(f_1\)</span>计算的积分有更小的方差。</p>
</div>
<div id="section-9" class="section level3">
<h3>5.14</h3>
<p>Obtain a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2π}} e^{−x^2/2} dx\)</span> by importance sampling.</p>
<p><span class="math inline">\(\textbf{解：}\)</span> 选用5.13中的两个重要函数：</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>) <span class="co">#只取&gt;1部分</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">##f1计算积分</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="co">#逆变换法生成服从Rayleigh分布的随机数X</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x<span class="sc">&lt;=</span><span class="dv">1</span>))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="co">#只取&gt;1部分</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>v[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="do">##f2计算积分</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) <span class="co">#using f2</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x<span class="sc">&lt;=</span><span class="dv">1</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="co">#只取&gt;1部分</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>v[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">estimate=</span><span class="fu">round</span>(est,<span class="dv">4</span>), <span class="at">variance=</span><span class="fu">round</span>(v,<span class="dv">4</span>))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res, <span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">estimate</td>
<td align="center">0.4008</td>
<td align="center">0.4198</td>
</tr>
<tr class="even">
<td align="left">variance</td>
<td align="center">0.1306</td>
<td align="center">1.4243</td>
</tr>
</tbody>
</table>
<p>通过估计值和方差的对比，<span class="math inline">\(f_1\)</span>与<span class="math inline">\(f_2\)</span>的积分估计值分别为0.4008和0.4198，比较接近；但<span class="math inline">\(f_1\)</span>的方差明显更小，符合9.13中的推测。</p>
</div>
</div>
</div>
<div id="section-10" class="section level1">
<h1>10-14</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p></li>
<li><p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis testing.</p></li>
</ol>
<div id="section-11" class="section level3">
<h3>6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.</p>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0: \mu = \mu_0\;vs \;H_1: \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-12" class="section level3">
<h3>6.5:</h3>
<p>由t检验的原理,均值的置信区间为<span class="math inline">\([\bar{X}-\frac{St_{n-1}(1-\frac{\alpha}{2})}{\sqrt{n}},\bar{X}+\frac{St_{n-1}(1-\frac{\alpha}{2})}{\sqrt{n}}]\frac{}{}\)</span>.其中<span class="math inline">\(\bar{X}\)</span>为样本均值,<span class="math inline">\(S\)</span>为样本标准差,<span class="math inline">\(t_{n-1}(1-\frac{\alpha}{2})\)</span>为自由度为<span class="math inline">\(n-1\)</span>的t分布的上<span class="math inline">\(\alpha/2\)</span>分位数.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>x_mean<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fl">1e3</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>x_sd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fl">1e3</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e3</span>){</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  x_mean[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x) <span class="co">#样本均值</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  x_sd[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(x) <span class="co">#样本标准差</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>t_alpha<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="at">p=</span><span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>coverage<span class="ot">&lt;-</span><span class="fu">mean</span>(x_mean<span class="sc">-</span>t_alpha<span class="sc">*</span>x_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">&lt;=</span><span class="dv">2</span><span class="sc">&amp;</span>x_mean<span class="sc">+</span>t_alpha<span class="sc">*</span>x_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">&gt;=</span><span class="dv">2</span>) <span class="co">#所有置信区间中能够覆盖真值2的所占的比例</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(coverage,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.926</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">##例6.4</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>} )</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>coverage2<span class="ot">&lt;-</span><span class="fu">mean</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(coverage2,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.797</code></pre>
<p>例6.4中方差的置信区间覆盖率仅为0.797,而本题均值的t置信区间覆盖率则为0.926.相比起来明显与0.95更为接近,说明对于轻微偏离正态的分布,t置信区间更为稳健.</p>
</div>
<div id="a-1" class="section level3">
<h3>6.A:</h3>
<p>本题中,我们选用<span class="math inline">\(n=100,\alpha=0.1\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">5e3</span> <span class="co">#重复次数</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>p_x<span class="ot">&lt;-</span>p_y<span class="ot">&lt;-</span>p_z <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#存储p值</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>) <span class="co">#X^2(1)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>) <span class="co">#U(0,2)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>) <span class="co">#Exp(1)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  ttest_x <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,<span class="at">mu=</span><span class="dv">1</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ttest_y <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y,<span class="at">mu=</span><span class="dv">1</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  ttest_z <span class="ot">&lt;-</span> <span class="fu">t.test</span>(z,<span class="at">mu=</span><span class="dv">1</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  p_x[j] <span class="ot">&lt;-</span> ttest_x<span class="sc">$</span>p.value</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  p_y[j] <span class="ot">&lt;-</span> ttest_y<span class="sc">$</span>p.value</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  p_z[j] <span class="ot">&lt;-</span> ttest_z<span class="sc">$</span>p.value</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>p_chisq.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_x <span class="sc">&lt;=</span> alpha)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>p_unif.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_y <span class="sc">&lt;=</span> alpha)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>p_exp.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_z <span class="sc">&lt;=</span> alpha)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">rbind</span>(p_chisq.hat,p_unif.hat,p_exp.hat) <span class="co">#3种分布的t1e</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1,<span class="at">align=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">p_chisq.hat</td>
<td align="left">0.1004</td>
</tr>
<tr class="even">
<td align="left">p_unif.hat</td>
<td align="left">0.0972</td>
</tr>
<tr class="odd">
<td align="left">p_exp.hat</td>
<td align="left">0.0944</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>se_chisq.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_chisq.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_chisq.hat) <span class="sc">/</span> m)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>se_unif.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_unif.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_unif.hat) <span class="sc">/</span> m)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>se_exp.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_exp.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_exp.hat) <span class="sc">/</span> m)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">rbind</span>(se_chisq.hat,se_unif.hat,se_exp.hat) <span class="co">#3种分布t1e标准差的估计值</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2,<span class="at">align=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">se_chisq.hat</td>
<td align="left">0.0042502</td>
</tr>
<tr class="even">
<td align="left">se_unif.hat</td>
<td align="left">0.0041893</td>
</tr>
<tr class="odd">
<td align="left">se_exp.hat</td>
<td align="left">0.0041349</td>
</tr>
</tbody>
</table>
<p>从三种分布得到的t1e可以看出,与<span class="math inline">\(\alpha=0.1\)</span>比较接近,标准差也处于较小的范围.这说明t-test对于轻微偏离正态的分布具有稳健性.</p>
</div>
<div id="project" class="section level3">
<h3>project:</h3>
<p>(1)设两种方法的功效分别为<span class="math inline">\(\alpha_1,\alpha_2\)</span>,则检验问题的假设为: <span class="math display">\[
H_0:\alpha_1=\alpha_2 \quad vs\quad H_1:\alpha_1\neq\alpha_2
\]</span> (2)可以使用paired t-test.可多次进行两种检验,将每次实验对应的功效值<span class="math inline">\(\alpha_{1,i},\alpha_{2,i}(i=1,2,...,n)\)</span>进行配对处理,即对应作差:<span class="math inline">\(\alpha_{1,i}-\alpha_{2,i}\)</span>应当近似服从t分布.</p>
<p>(3)检验至少需要的信息:每次实验中两种方法功效的差值<span class="math inline">\(\{ d_i \}_{i=1}^{n}=\{ \alpha_{1,i}-\alpha_{2,i} \}_{i=1}^{n}\)</span>.</p>
</div>
</div>
</div>
<div id="section-13" class="section level1">
<h1>10-21</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 6.C (page 180-181, Statistical Computating with R).</li>
</ul>
<div id="c" class="section level3">
<h3>6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(β_{1,d}\)</span>,is defined by Mardia as <span class="math display">\[
\beta_{1,d}= E[(X − \mu)^T Σ^{−1}(Y − \mu)]^3.
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}= 0\)</span>. The multivariate skewness statistic is <span class="math display">\[
b_{1,d}=\frac{1}{n^2} \sum_{i,j=1}^{n} ((X_i−\bar{X})^T \hat{Σ}^{−1}(X_j−\bar{X}))^3
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span>are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1 ) (d + 2 )/6\)</span> degrees of freedom.</p>
</div>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="c-1" class="section level3">
<h3>6.C</h3>
<p>由题干,假设检验的拒绝域为: <span class="math display">\[
W=\{ x:b_{1,d} \geqslant 
\frac{6\chi^2_{m}(1-\alpha)}{n} \}, m=d(d + 1 ) (d + 2 )/6
\]</span> 协方差阵的极大似然估计<span class="math inline">\(\hat{\Sigma}\)</span>: <span class="math display">\[
\hat{\Sigma}=\frac{1}{n}\sum_{i=1}^n(X_i−\bar{X}) (X_i−\bar{X})^T
\]</span> 其中中心化的s数据阵<span class="math inline">\(X-\bar{X}\)</span>: <span class="math display">\[
(X_1-\bar{X},...,X_n-\bar{X})=(X_1,...,X_n) 
\left( \begin{matrix}
\frac{n-1}{n}&amp;\frac{1}{n}&amp;\cdots&amp;\frac{1}{n}\\
\frac{1}{n}&amp;\frac{n-1}{n}&amp;\cdots&amp;\frac{1}{n}\\
\vdots&amp; &amp;\ddots\\
\frac{1}{n}&amp;\frac{1}{n}&amp;...&amp;\frac{n-1}{n}
\end{matrix} \right)
\]</span> 本题中,我们选用均值为<span class="math inline">\((0,0)\)</span>,协方差阵为单位阵的二元正态分布.检验水平<span class="math inline">\(\alpha=0.05\)</span>.</p>
<p>(1)首先对于例6.8:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">nrow</span>(data) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">ncol</span>(data)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  mu<span class="ot">&lt;-</span><span class="fu">numeric</span>(d)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  mat_cent<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">1</span>,n)<span class="sc">-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">/</span>n,n,n) <span class="co">#中心化X时的右乘矩阵,可以看作单位阵I-所有元素全为1/n的矩阵</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cov_hat&lt;-t(data)%*%mat_cent%*%data/n</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  cov_hat<span class="ot">&lt;-</span><span class="fu">cov</span>(data)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="co">#r中cov函数计算的是修正后的协方差阵,除数是n-1</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  data_cent<span class="ot">&lt;-</span>mat_cent<span class="sc">%*%</span>data <span class="co">#中心化data</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  mat_bd<span class="ot">&lt;-</span>data_cent<span class="sc">%*%</span><span class="fu">solve</span>(cov_hat)<span class="sc">%*%</span><span class="fu">t</span>(data_cent) <span class="co">#solve函数求逆矩阵</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  b1d<span class="ot">&lt;-</span><span class="fu">sum</span>(mat_bd<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (b1d)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">300</span>) <span class="co">#每次的样本量</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#每次模拟的重复次数</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#多元分布的维数</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>dg<span class="ot">&lt;-</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span> <span class="co">#X^2分布的自由度</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>,dg)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n <span class="co">#检验临界值</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>mean<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span>d,<span class="at">ncol=</span>d)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  cnts_reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],mean,sigma)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    cnts_reject[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x) <span class="sc">&gt;=</span> cv[i])</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(cnts_reject) <span class="co">#拒绝比例</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">rbind</span>(n,p.reject)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">1e+01</td>
<td align="right">20.000</td>
<td align="right">30.000</td>
<td align="right">50.000</td>
<td align="right">100.000</td>
<td align="right">300.000</td>
</tr>
<tr class="even">
<td align="left">p.reject</td>
<td align="right">4e-03</td>
<td align="right">0.018</td>
<td align="right">0.048</td>
<td align="right">0.037</td>
<td align="right">0.049</td>
<td align="right">0.055</td>
</tr>
</tbody>
</table>
<p>从各样本量对应模拟的t1e值可以看出,当样本量较大(<span class="math inline">\(\geq50\)</span>)时,t1e值与<span class="math inline">\(\alpha\)</span>值较为接近.</p>
<p>(2)对于例6.10,我们选用样本量为100,<span class="math inline">\(\alpha=0.5\)</span>.构造类似的混合分布： <span class="math display">\[
(1-\epsilon)MN_1+\epsilon MN_2=(1 − ε)N_2(\mu,\Sigma_1) + εN_2(\mu,\Sigma_2),
\]</span> 其中, <span class="math display">\[
\mu= \left(\begin{matrix} 
0\\
0
\end{matrix} \right),
\Sigma_1=\left(\begin{matrix} 
1&amp;0\\
0&amp;1
\end{matrix} \right),
\Sigma_2=\left(\begin{matrix} 
10&amp;0\\
0&amp;10
\end{matrix} \right)
\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#样本量</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#每次重复的次数</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.02</span>), <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>,dg)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n <span class="co">#检验临界值</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>Sigma_1<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">1</span>,d,d) <span class="co">#MN1的协方差阵</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>Sigma_10<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">10</span>,d,d) <span class="co">#MN2的协方差阵</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  cnts_reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e)) <span class="co">#以概率1-e由N1生成,概率2由多元正态分布2生成</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    n_1<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(sigma<span class="sc">==</span><span class="dv">1</span>)) <span class="co">#由MN1生成的数量</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    n_10<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(sigma<span class="sc">==</span><span class="dv">10</span>)) <span class="co">#由MN2生成的数量</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_1<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> n_10<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      x1<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n_1,mean,Sigma_1)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>      x2<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n_10,mean,Sigma_10)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">rbind</span>(x1,x2)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (n_1<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n_1,mean,Sigma_1)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n_10,mean,Sigma_10)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    cnts_reject[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x) <span class="sc">&gt;=</span> cv)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  power[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(cnts_reject)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, power, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;empirical power curve&quot;</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon,power,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span><span class="fl">0.05</span>, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#直线:y=0.05</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(power <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>power) <span class="sc">/</span> m) <span class="co">#标准差</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, power<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>) </span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, power<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.16</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#最高点在0.16附近取得</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">rbind</span>(epsilon,power)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">epsilon</td>
<td align="right">0.000</td>
<td align="right">0.020</td>
<td align="right">0.040</td>
<td align="right">0.060</td>
<td align="right">0.080</td>
<td align="right">0.100</td>
<td align="right">0.120</td>
<td align="right">0.140</td>
<td align="right">0.160</td>
<td align="right">0.180</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.250</td>
<td align="right">0.300</td>
<td align="right">0.350</td>
<td align="right">0.400</td>
<td align="right">0.450</td>
<td align="right">0.500</td>
<td align="right">0.550</td>
<td align="right">0.600</td>
<td align="right">0.650</td>
<td align="right">0.700</td>
<td align="right">0.750</td>
<td align="right">0.800</td>
<td align="right">0.850</td>
<td align="right">0.900</td>
<td align="right">0.950</td>
<td align="right">1.000</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="right">0.044</td>
<td align="right">0.506</td>
<td align="right">0.724</td>
<td align="right">0.841</td>
<td align="right">0.891</td>
<td align="right">0.907</td>
<td align="right">0.913</td>
<td align="right">0.919</td>
<td align="right">0.925</td>
<td align="right">0.915</td>
<td align="right">0.896</td>
<td align="right">0.901</td>
<td align="right">0.869</td>
<td align="right">0.854</td>
<td align="right">0.787</td>
<td align="right">0.714</td>
<td align="right">0.653</td>
<td align="right">0.572</td>
<td align="right">0.498</td>
<td align="right">0.398</td>
<td align="right">0.311</td>
<td align="right">0.272</td>
<td align="right">0.201</td>
<td align="right">0.156</td>
<td align="right">0.118</td>
<td align="right">0.087</td>
<td align="right">0.057</td>
<td align="right">0.047</td>
</tr>
</tbody>
</table>
<p>当<span class="math inline">\(\epsilon=0,1\)</span>时,图线低于<span class="math inline">\(\alpha=0.05\)</span>,与此时的确为多元正态分布相吻合;其余部分则均大于<span class="math inline">\(\alpha\)</span>,其中大约在<span class="math inline">\(0.16\)</span>附近达到最大值.</p>
</div>
</div>
</div>
<div id="section-14" class="section level1">
<h1>10-28</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 7.7 ,7.8 ,7.9 and 7.B (pages 213,Statistical Computating with R).</li>
</ul>
<div id="section-15" class="section level3">
<h3>7.7</h3>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84,Ch. 7]. The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1 &gt; ··· &gt; \lambda_5\)</span>. In principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}
\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_1 &gt; ··· &gt; \hat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\({\Sigma}\)</span> Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^{5}\hat{\lambda}_j}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="section-16" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\theta\)</span></p>
</div>
<div id="section-17" class="section level3">
<h3>7.9</h3>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="b" class="section level3">
<h3>7.B</h3>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness)</p>
</div>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-18" class="section level3">
<h3>7.7</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(scor)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values <span class="co">#eigen求特征值</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span><span class="fu">max</span>(lambda_hat)<span class="sc">/</span><span class="fu">sum</span>(lambda_hat)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>theta_B<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ind<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  scor_i<span class="ot">&lt;-</span>scor[ind,]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  lambda_i<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor_i))<span class="sc">$</span>values</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  theta_B[i]<span class="ot">&lt;-</span><span class="fu">max</span>(lambda_i)<span class="sc">/</span><span class="fu">sum</span>(lambda_i)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>theta_B_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(theta_B)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>bias_B<span class="ot">&lt;-</span>theta_B_hat<span class="sc">-</span>theta_hat</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>se_B<span class="ot">&lt;-</span><span class="fu">sd</span>(theta_B)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(theta_B_hat,bias_B,se_B))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_B_hat</th>
<th align="right">bias_B</th>
<th align="right">se_B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6188688</td>
<td align="right">-0.0002462</td>
<td align="right">0.0481896</td>
</tr>
</tbody>
</table>
<p>Bootstrap给出的<span class="math inline">\(\theta\)</span>估计值为0.6189, bias为0.0002, 标准差为0.0482.</p>
</div>
<div id="section-19" class="section level3">
<h3>7.8:</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>theta_j<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  scor_i<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  lambda_i<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor_i))<span class="sc">$</span>values</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  theta_j[i]<span class="ot">&lt;-</span><span class="fu">max</span>(lambda_i)<span class="sc">/</span><span class="fu">sum</span>(lambda_i)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>theta_j_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(theta_j)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>bias_j<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(theta_j_hat<span class="sc">-</span>theta_hat)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>se_j<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">sum</span>((theta_j<span class="sc">-</span>theta_j_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(theta_j_hat,bias_j,se_j),<span class="at">algn=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_j_hat</th>
<th align="right">bias_j</th>
<th align="right">se_j</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6191273</td>
<td align="right">0.0010691</td>
<td align="right">0.0495523</td>
</tr>
</tbody>
</table>
<p>Jackknife给出的<span class="math inline">\(\theta\)</span>估计值为0.6191, bias为0.0011, 标准差为0.0496.</p>
</div>
<div id="section-20" class="section level3">
<h3>7.9:</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>boot.theta<span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  lambda_i<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x[i,]))<span class="sc">$</span>values</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  theta_B<span class="ot">&lt;-</span><span class="fu">max</span>(lambda_i)<span class="sc">/</span><span class="fu">sum</span>(lambda_i)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  theta_B</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(scor, <span class="at">statistic =</span> boot.theta, <span class="at">R=</span><span class="dv">500</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="do">##percentile CI</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="do">##Bca CI</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(ci.perc,ci.bca),<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">ci.perc</td>
<td align="center">0.5221962</td>
<td align="center">0.7103804</td>
</tr>
<tr class="even">
<td align="left">ci.bca</td>
<td align="center">0.5276149</td>
<td align="center">0.7222033</td>
</tr>
</tbody>
</table>
<p>Bootstrap给出的percentile和BCa置信区间分别为[0.5222,0.7104]和[0.5276,0.7222].</p>
</div>
<div id="b-1" class="section level3">
<h3>7.B</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[i] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[i] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>sk_chi_5 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>ci1.norm<span class="ot">&lt;-</span>ci1.basic<span class="ot">&lt;-</span>ci1.perc<span class="ot">&lt;-</span>ci2.norm<span class="ot">&lt;-</span>ci2.basic<span class="ot">&lt;-</span>ci2.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n);x2<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  de1 <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x1,<span class="at">statistic=</span>sk, <span class="at">R =</span> <span class="fl">1e3</span>);de2<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>x2,<span class="at">statistic=</span>sk,<span class="at">R=</span><span class="fl">2e2</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  ci1 <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de1,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>));ci2<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(de2,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  ci1.norm[i,]<span class="ot">&lt;-</span>ci1<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci2.norm[i,]<span class="ot">&lt;-</span>ci2<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  ci1.basic[i,]<span class="ot">&lt;-</span>ci1<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci2.basic[i,]<span class="ot">&lt;-</span>ci2<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  ci1.perc[i,]<span class="ot">&lt;-</span>ci1<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci2.perc[i,]<span class="ot">&lt;-</span>ci2<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">#coverage</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>normal_norm<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci1.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>);chisq_norm<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sk_chi_5 <span class="sc">&amp;</span> ci2.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span> sk_chi_5)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>normal_basic<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci1.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>);chisq_basic<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span> sk_chi_5 <span class="sc">&amp;</span> ci2.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sk_chi_5)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>normal_perc<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci1.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>);chisq_perc<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span> sk_chi_5 <span class="sc">&amp;</span> ci2.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span> sk_chi_5)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">#the proportion of times that the confidence intervals miss on the left</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>normal_norm_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>);chisq_norm_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span> sk_chi_5)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>normal_basic_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>);chisq_basic_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span> sk_chi_5)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>normal_perc_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>);chisq_perc_left<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span> sk_chi_5)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">#the proportion of times that the confidence intervals miss on the right</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>normal_norm_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>);chisq_norm_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span> sk_chi_5)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>normal_basic_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>);chisq_basic_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span> sk_chi_5)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>normal_perc_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci1.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>);chisq_perc_right<span class="ot">&lt;-</span><span class="fu">mean</span>(ci2.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span> sk_chi_5)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>ci_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co">#standard normal</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>normal_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(normal_norm, normal_basic, normal_perc)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>normal_left<span class="ot">&lt;-</span><span class="fu">c</span>(normal_norm_left,normal_basic_left,normal_perc_left)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>normal_right<span class="ot">&lt;-</span><span class="fu">c</span>(normal_norm_right,normal_basic_right,normal_perc_right)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ci_type,normal_cover,normal_left,normal_right)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">ci_type</th>
<th align="right">normal_cover</th>
<th align="right">normal_left</th>
<th align="right">normal_right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.902</td>
<td align="right">0.043</td>
<td align="right">0.055</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.897</td>
<td align="right">0.048</td>
<td align="right">0.055</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">0.967</td>
<td align="right">0.014</td>
<td align="right">0.019</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#chisq</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>chisq_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_norm, chisq_basic, chisq_perc)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>chisq_left<span class="ot">&lt;-</span><span class="fu">c</span>(chisq_norm_left,chisq_basic_left,chisq_perc_left)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>chisq_right<span class="ot">&lt;-</span><span class="fu">c</span>(chisq_norm_right,chisq_basic_right,chisq_perc_right)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ci_type,chisq_cover,chisq_left,chisq_right)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">ci_type</th>
<th align="right">chisq_cover</th>
<th align="right">chisq_left</th>
<th align="right">chisq_right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.732</td>
<td align="right">0.020</td>
<td align="right">0.248</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.718</td>
<td align="right">0.034</td>
<td align="right">0.248</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">0.719</td>
<td align="right">0.000</td>
<td align="right">0.281</td>
</tr>
</tbody>
</table>
<p>标准正态分布的basic和normal置信区间的覆盖率都在90%左右, 而percentile覆盖率为96.7%, 更接近95%, 区间估计得更为准确. 三者都有90%及以上的高覆盖率,和标准正态分布的偏度为0相吻合.</p>
<p><span class="math inline">\(\chi^2(5)\)</span>三者的置信区间覆盖率都在70+%, 均和95%相差很远. 再结合left,right的数据, 可以发现<span class="math inline">\(\chi^2(5)\)</span>整体分布具有正的偏度.</p>
</div>
</div>
</div>
<div id="section-21" class="section level1">
<h1>11-04</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercise 8.2 (page 242, Statistical Computating with R).Implement the bivariate Spearman rank correlation test for independence[255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p></li>
<li><p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</li>
</ol>
<div id="section-22" class="section level3">
<h3>8.2</h3>
<p>本题中, 两样本均为随机生成的正态随机数.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">399</span>;z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y);K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z);n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n) <span class="co"># 置换后x对应的下标</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[ind];y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>ind]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> t0),<span class="dv">3</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearm&quot;</span>)<span class="sc">$</span>p.value,<span class="dv">3</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,p0),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.880 0.881</code></pre>
<p>从最终的结果可以看出, 利用置换检验和cor.test得到的p值较为接近, 分别为0.88和0.881, 显著不拒绝两样本独立的原假设.</p>
</div>
<div id="design-experiments" class="section level3">
<h3>Design Experiments</h3>
<p>(1)Unequal variances and equal expectations</p>
<p>本题中,选用两样本分别服从分布N(0,1), N(0,1.4).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;boot&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;RANN&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;energy&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">3e2</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; mu <span class="ot">&lt;-</span> <span class="fl">0.3</span>; <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span>; R<span class="ot">&lt;-</span><span class="dv">99</span>; n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.4</span>),<span class="at">ncol=</span>p)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>,<span class="at">seed=</span>i)<span class="sc">$</span>p.value</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>name<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;knn&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;ball&#39;</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(name,power),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="center">knn</td>
<td align="center">energy</td>
<td align="center">ball</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="center">0.316666666666667</td>
<td align="center">0.396666666666667</td>
<td align="center">0.756666666666667</td>
</tr>
</tbody>
</table>
<p>在期望相同, 方差不同情形下, ball检验的power明显最好, 优于knn和energy检验.</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>本题中,选用两样本分别服从分布N(0,1), N(0.3,1.2).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="fl">0.3</span>,<span class="fl">1.2</span>),<span class="at">ncol=</span>p)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>,<span class="at">seed=</span>i)<span class="sc">$</span>p.value</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(name,power),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="center">knn</td>
<td align="center">energy</td>
<td align="center">ball</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="center">0.286666666666667</td>
<td align="center">0.576666666666667</td>
<td align="center">0.62</td>
</tr>
</tbody>
</table>
<p>在均值和方差均不同的情形下, energy和ball检验表现相近, 优于knn.</p>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<p>本题中, 混合正态分布选为: 0.5N(0,1)+0.5N(0,1.3).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p,<span class="at">df=</span><span class="dv">1</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2 <span class="sc">*</span> p,<span class="at">mean=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">sd =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.3</span>), <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> <span class="fu">matrix</span>(y,<span class="at">ncol=</span>p)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>,<span class="at">seed=</span>i)<span class="sc">$</span>p.value</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(name,power),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="center">knn</td>
<td align="center">energy</td>
<td align="center">ball</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="center">0.763333333333333</td>
<td align="center">0.983333333333333</td>
<td align="center">0.99</td>
</tr>
</tbody>
</table>
<p>在非正态情形下, energy和ball检验表现相近, 比knn更好.</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ol>
<p>本题中, 样本量分别选为50和5, 分别服从分布N(0,1), N(0.9,1).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">50</span>;n2 <span class="ot">&lt;-</span> <span class="dv">5</span>;n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2;N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ncol =</span> p)<span class="co">#50 samples</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="fl">0.9</span>,<span class="dv">1</span>), <span class="at">ncol =</span> p)<span class="co">#5 samples</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  p.values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z, N, k)<span class="sc">$</span>p.value</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  p.values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes =</span> N, <span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  p.values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">R =</span> <span class="dv">99</span>, <span class="at">seed =</span> i)<span class="sc">$</span>p.value</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(name,power),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="center">knn</td>
<td align="center">energy</td>
<td align="center">ball</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="center">0.366666666666667</td>
<td align="center">0.743333333333333</td>
<td align="center">0.483333333333333</td>
</tr>
</tbody>
</table>
<p>在不平衡样本情形下, energy检验表现最好, ball 检验次之, 最后是knn 检验.</p>
</div>
</div>
</div>
<div id="section-23" class="section level1">
<h1>11-11</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p></li>
<li><p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span></p></li>
</ul>
<div id="section-24" class="section level3">
<h3>9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and com- pare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchyor qt with df=1). Recall that a Cauchy(θ,η) distribution has density function <span class="math display">\[
f(x)=\frac{1}{\theta \pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0
\]</span> The standard Cauchy has the Cauchy(θ = 1,η = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="section-25" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto \left( 
\begin{matrix} 
n\\
x
\end{matrix}
\right) y^{x+a-1}(1-y)^{n-x+b-1}, x=0,1,...,n, 0\leq y\leq 1
\]</span> It can be shown (see e.g. [23]) that for fixed a,b,n, the conditional distribu- tions are Binomial(n,y) and Beta(x+a,n−x+b). Use the Gibbs sampler to generate a chain with target joint density f(x,y).</p>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-26" class="section level3">
<h3>9.3</h3>
<p>提议分布<span class="math inline">\(g\)</span>选用对称分布<span class="math inline">\(N(X_t,\sigma^2)\)</span>, 故<span class="math inline">\(g(X_t)=g(Y)\)</span>, <span class="math display">\[
\alpha(X_t,Y)=\min(1,\frac{f(Y)g(X_t)}{f(X_t)g(Y)})=\min(1,\frac{f(Y)}{f(X_t)})
\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cauchy.metropolis<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>x0</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i]<span class="sc">&lt;=</span><span class="fu">dcauchy</span>(y)<span class="sc">/</span><span class="fu">dcauchy</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">5000</span> <span class="co">#链长为5000</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fl">2.5</span> <span class="co">#sigma值选为2.5</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co">#初值选为0</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="fl">1e3</span> <span class="co">#预烧期为1000</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>chain<span class="ot">&lt;-</span><span class="fu">cauchy.metropolis</span>(sigma,x0,N)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(chain,type=&quot;l&quot;)</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">ppoints</span>(<span class="dv">25</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>QR<span class="ot">&lt;-</span><span class="fu">qcauchy</span>(a)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>Q<span class="ot">&lt;-</span><span class="fu">quantile</span>(chain[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],a)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QR,Q,<span class="at">xlab=</span><span class="st">&quot;theorical&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;practical&quot;</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chain[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>pi),<span class="at">main=</span><span class="st">&quot;Hist&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(X[t]))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>,<span class="fl">0.01</span>),<span class="fu">dcauchy</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>,<span class="fl">0.01</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6kLY6kNtmAABmADpmOgBmOpBmkJBmkLZmtv+QOgCQZgCQkGaQtv+Q2/+2ZgC2Zjq2ZpC229u22/+2///T09PbkDrbkGbbtmbb/7bb/9vb////AAD/tmb/25D/27b//7b//9v///+USNyEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHf0lEQVR4nO2da2ObNhiF5bSJd5+9bou3hW2pWbdgx+b//7ohBJjYwLFAl9fkPF+aOupr8VTohiRUTgZRsTMgHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAggT9Bxo+5fzJ8PzV9av/7rc9Ds3Jqg1093FNQSdEGiKKijBP3zjVKLH561n4Kgim5CUKpUJYaCSjE1laDDWj285F+UWvEWy7sE7Zfq49/VbymoQ5D55MOv+sajoK466PVT6WvxBwXlPf2g19+Ldkz/SEG9HcXjb6YZo6ALQTulfizvs7LFXzwFzc4tCMr/NHW2VrNjP6jrFvuia6DvnvWnhayPzwGzI0+QMCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAGME7ZePzvMhFhtBh3Wz/jT0Qrh4WJWgnV7KzRI0wGGt13tR0ADJ4omCBknVioIG2S8/UNAgx42iIFIzUlDKfpBdlAYn4STh+IooKGw4AdhdUb0bsLcGeueCUjMWawZlE8PdBDZXdNys6h/TswMjxoS7DeymO5oO4q7nJnvfgliCEGk9xmAd1EM9p9hTfigodDgBUBCAggAUBKAgAAUBxAuKPckkX9B2S0GDESkIRNxuM+dBbb5fdDgdMctkCNJHzTkM5wwtKKah1hXp0wpX7sI5QpCg3IGjuQsyiiY8FJy5IH3+1WN+3PRO9/RG8ffgMBMjSE+GGTN9E85W4VyRZVsZgg5rF8fLzVnQT8bPhOKTexMU0dCFoGnrNmYrKDlVsysH4RxSCFICBJ1KkKNwzhAjSGS4nIIQmQxBh/Wq2Wcgq5Iu/EgQJDUcBUEECSpuMz1UtR6H9YRzRCUo3sz96XsT/fqBhzyZNG3mS1C8ienWWOyxGM0/Dg810nK4n/f3t30JymQISorLHhpqpMV49rDWRSysoK0EQcW9pXeDmevvxqwwK6eL3qOgoiO0eDpuBqqgeo1iUVu9R0GYZo1i8kBBndRaisIWSFAmSBBcRZ+fVnEeN8EEKTGCEhc7nGYsSHekHYZzhChBNvssQ1XSggQNNvAwiq/nYo2gLLqgcpzhMJwbKkFKgCCZE2aCBF1F8A11NyYo+Ia6TJSg4ia7f0lW/WnDb4fSrZcYQbvFU6pH86vetOE31EkSpItHOjCRkb/3EqSLh77soRnF4BvqJAmqS1AyNGsfekNdS1CsBxvndVA6rbvoS1C8NUJvWzE19SWdsxYkMBwFDZNJEmTq32nPVd0LUidBkZ6t1t+aVA8EJ6619ygo0oxQ9a27unKeeMKdR0GRekLmW1uzZZKezcsR1BqBCVrlqlqCtrEFwWGoTThHZBQ0TNnIU1A/FAQ4ExSnq1gLcnSU9lwFyQz3RlCslZxursjLg8NsRoK8hDMrX1qCohiiIMDtCIrU0MsVlFHQMPVD1ZagGPcYBQHECsouBMVp6AUL2l4KimCIggBSBWUdgqJMK8oVpChogKxTUIybTKwg1SMotCGZaxTPBvKNoAh9IZFrFC9GGY2g8IZGbYfyvMKso4/YFhT2IbTNdwVao9jZwteCVOgTqeSVoO4GrBFUlqGAiizrIM9rFE356GrAToICK7K7Ir9rFKsLV11utm8+zcI5ktEPymq2Wj8W1CjyrymaoOySbhW9n3ZE8KBrpKC+NSDdmYaYG9dSULvOtsezoPMoNbZOXCNV0IyhIIDjwer8cDxYnR+OhxrtyALxLMhumVVv5L5fRPwHA3gsQba/uH1BVwxWr4k8Y0F4sHpN5DkLchKZgkBkCgKRKQhEpiAQmYJmBQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJ4ErT/Wj/1MDO0Vx4GYpXYMvWoDBn8CDqsy8dC+68sDvyySmyZelSGDF4E7aqH01aHFNidaGCZekyGDD4E7dTK5CS1KcxWie1Sj8uQwVMdZPKTfKuuf2eiVWLL1KMyZPApSL/ppcjUdRmySmyZelSGKryWoPMfrf6d29RjMxRAkNWpaHZHqFmkHpshx4Ka17G38wOb1tZL3L219VYZauOzBJn/qitLtFViy9SjMlThtxXTreq1daJVYsvUozJk8FsH6TckX33DWyW2TD0qQyUcrAIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEEC1ovzTbqye+unMSogVV+/P3y1W8LMgWlCd3n9tvh4uAcEGH9cPEV8JNRbig4vb6ZdpbF6ciXdDk93ZORbqg4ybycVfSBSX3/65j1tHSBe2KHlDZ1h9+nvgO4bHIFrRflkvCFk/5/nsKuuS4uTNbUO7/20x+DfVIJAsqKmjTwu/UA0sQgIIAFASgIIDZhxKBWxEUDQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/VVxmzuXBHoYAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-27" class="section level3">
<h3>9.8</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gibbs<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b,x0,<span class="at">N=</span><span class="dv">5000</span>){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> x0</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="fl">0.5</span>) <span class="co">#x,y初值分别选为10,0.5</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span>b<span class="ot">&lt;-</span><span class="dv">5</span>;n<span class="ot">&lt;-</span><span class="dv">20</span> <span class="co">#a,b,n,分别选为5,5,20</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">gibbs</span>(n,a,b,x0,N)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>X[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(t(colMeans(x))) #x,y均值</span></span></code></pre></div>
</div>
<div id="gelman-rubin" class="section level3">
<h3>Gelman-Rubin</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 9.3</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#生成链的条数</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#每条链的长度</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co">#预烧期</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="co">#4个不同初值</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.metropolis</span>(sigma, x0[i],N)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum)) <span class="co">#cumsum计算累加和</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) <span class="co">#psi储存累积均值; 1:ncol(psi)对应每个时刻的链长</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.164304</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(2,2))</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:k)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(psi[i, (b+1):N], type=&quot;l&quot;,xlab=i, ylab=bquote(psi))</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, (N<span class="sc">-</span>burn))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  r.hat[j<span class="sc">-</span>burn] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])<span class="co">#生成Gelman-Rubin统计量r.hat</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r.hat, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;t&quot;</span>, <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">hat</span>(R)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">max</span>(r.hat)<span class="sc">+</span><span class="fl">0.1</span>))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="co">#临界值1.2</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">##9.8 </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#生成链的条数</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#每条链的长度</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#预烧期</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>X0<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="fl">0.6</span>,<span class="dv">10</span>,<span class="fl">0.55</span>,<span class="dv">10</span>,<span class="fl">0.45</span>,<span class="dv">13</span>,<span class="fl">0.4</span>),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  X1[i, ] <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(n,a,b,X0[i,],N)[,<span class="dv">1</span>]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  X2[i, ] <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(n,a,b,X0[i,],N)[,<span class="dv">2</span>]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum)) <span class="co">#cumsum计算累加和</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum)) </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1)){</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1)) <span class="co">#psi储存累积均值; 1:ncol(psi)对应每个时刻的链长</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2)) </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2)))</span></code></pre></div>
<pre><code>## [1] 1.136941 1.192141</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>r1.hat <span class="ot">&lt;-</span> r2.hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, (N<span class="sc">-</span>burn))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  r1.hat[j<span class="sc">-</span>burn] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])<span class="co">#生成Gelman-Rubin统计量r.hat</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  r2.hat[j<span class="sc">-</span>burn] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r1.hat, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;t&quot;</span>, <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">hat</span>(R[<span class="dv">1</span>])),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">max</span>(r1.hat)<span class="sc">+</span><span class="fl">0.1</span>))</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="co">#临界值1.2</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r2.hat, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;t&quot;</span>, <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">hat</span>(R[<span class="dv">2</span>])),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">max</span>(r2.hat)<span class="sc">+</span><span class="fl">0.1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="co">#临界值1.2</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="section-28" class="section level1">
<h1>11-18</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</li>
<li>Suppose T1, . . . , Tn are i.i.d. samples drawn from the exponential distribution with expectation λ. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i ≤ \tau ) + \tau I(T_i &gt; τ ),i = 1, . . . , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85.\]</span> Use the E-M algorithm to estimate λ, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</li>
</ul>
<div id="section-29" class="section level3">
<h3>11.3</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">###(1)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>f_k<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  a_mod<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(a<span class="sc">%*%</span>a)) <span class="co">#计算a的2-范数</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  f_k0<span class="ot">&lt;-</span>a_mod<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">gamma</span>(d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co">#k=0时单独计算</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (f_k0)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {<span class="fu">return</span> ( (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">log</span>(<span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">-</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">seq</span>(<span class="dv">1</span>,k,<span class="dv">1</span>))) <span class="sc">-</span> k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                                (<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a_mod) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)))} <span class="co">#防止超界先取对数</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="do">###(2)</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>f_sum<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(<span class="fu">f_k</span>(a,k))<span class="sc">&gt;=</span><span class="fl">1e-6</span>){</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">&lt;-</span>s<span class="sc">+</span><span class="fu">f_k</span>(a,k)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#只计算&gt;10^{-6}的项</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (s)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="do">###(3)</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">f_sum</span>(a),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 1.5322</code></pre>
<p><span class="math inline">\(a=(1,2)^T\)</span>代入计算得到的结果为1.5322.</p>
</div>
<div id="section-30" class="section level3">
<h3>11.5</h3>
<p>记自由度为<span class="math inline">\(k\)</span>的t分布的密度函数为<span class="math inline">\(f_k\)</span>, 则等式左右两端分别可看作<span class="math inline">\(2f_{k-1},2f_k\)</span>在<span class="math inline">\([0,c_k]\)</span>上的积分.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># g &lt;- function(u,k){</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   return ((1+u^2/k)^(-(k+1)/2))</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># I &lt;- function(a,k){</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   ck&lt;-sqrt(a^2*k/(k+1-a^2))</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   I1&lt;-integrate(g,lower=0,upper=ck,k=k)$value</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   return (2*exp(log(gamma((k+1)/2))-log(gamma(k/2)))/sqrt(pi*k)*I1)</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>I<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  ck<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">integrate</span>(dt,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span>ck,<span class="at">df=</span>k)<span class="sc">$</span>value)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>diff<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(a,k)<span class="sc">-</span><span class="fu">I</span>(a,k<span class="dv">-1</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">#为确定根的范围, 作出下列a-diff图示</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>k0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">4</span>)<span class="sc">-</span><span class="fl">1e-2</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="fu">length</span>(a),<span class="at">nrow=</span><span class="fu">length</span>(k0))</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k0)){</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)){</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    res[i,j]<span class="ot">=</span><span class="fu">diff</span>(a[j],k0[i])</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co">#分四组分别做出图示</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,res[<span class="dv">1</span>,],<span class="at">col=</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,res[<span class="dv">2</span>,],<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=4&quot;</span>,<span class="st">&quot;k=8&quot;</span>),<span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAnFBMVEUAAAAAADoAAGYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OpA6ZmY6ZrY6kNth0E9mAABmOjpmOmZmZmZmZpBmkNtmtv+QOgCQOmaQZpCQkGaQttuQ29uQ2/+2ZgC2Zjq2Zma2kGa2tra22/+2///bkDrbkGbbtmbbtpDb27bb29vb2//b/9vb///fU2v/tmb/25D/27b//7b//9v///+7nmN+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHcElEQVR4nO2dbWPaNhhFyZJl69ZClzSs26BtGrotW4AF////NsAv2CDpPpIlS7bv+VLDHl+bU1mWbNebZMTIJPYOpA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJ4FjTpDbEE+Y0Lt20K8lWcoqD1gcDb7qmg9TnBtt1HQQ0tDooGLkipw8rRkAXpRVgoGrAgowSxIeO2vy2qxdUDKhan2uMShwXIFJXbVnbze0H/5Evb9/0SJGogoqJJrfZS0B+fF3/d3d1/3X38s0+CxB2MXJCab28est3z8/O+KW16JMjiHIVLzYJ+//Xpv8fHx3+/3L3/6aUvgqyGOfAwA5309m2x2JsWZD2haCPIuTieIIcJl3mNgQlymo8apQ5KkNt83ax1SIJc/RgNldueNii+rEbSu08/L+Q7GkmQsx7jusW2pzpB+Uh69bD7mPppvo0fw9rm03w5kt7ef/mAisWp9kji3I+van37bZ9G0h/+vk+7BbXUo08QjaRfPj9lnxYpC2rvR9cEZSPp7S+/vUXF4lR7YJwHP7qUQZzm/fhR5wxBkC8/hyTbbTsWdyrInx9VVMqCZLe8PfpRhaUsSBTn1Y/iIOv7wwue/Si7ITnpCfLuZ2CC/PtpF5maoAB+2oWmJ8jvdspU59jEBAVpQK1y0xIUyk+LlpmSoLbXf0wMRJDfbTSzHcMTEhSw/bRIT0dQWD/O+YEE7eb5ROa7J2lcaD+uR3AYQavJu3xhUy6gOKGfqRbByk6GggjazSstq+sXURzaeb0Zuah0BL3OHsrFjeYgO4szNCDZ75d4cjqK02hBml23O4LOV7lcx8VQqD6oaEKyPki14/ZuBCsnI2h/kOVnMU37acZd+GnjRpFSi7E3lMA46GyG4UXOeViZ1kdBdT1e5ahSkxEkHyhWfsLIyZrhU2tD0QeK+R4HtVPg1rPFPs0fGlAHckrsHUUeKK7XHdopNmknKW4LWndt57jRtc3R1vFAsbpf+f2B/Y7mf2ZZlD+nku0HEWQ3UOwYxbDC0JLij4O6p3mqB5LGKUg3tVFoCi1oJbvc0S3K0eJ0qvQ0xhZkmnFcSBqrIMkFzOPSOAVZTFqjT1bjEFuQ/V2NjpFffI09WY2F2FAidzW6J6qgHrQgsaEk7mpEIaqgpCerBXEFdR3ngodXxTgVRolzQXYiG7EgWRMasyCRIQoCjFqQxBAFAcYuqN3rqpwKo8S5QkEIaIiC2rzwzKkwSpw7FIQAhjoWZP+PiYOTlqBQcS2gIISndwoOWZCXdwoOV5C5CVFQZjZEQRkFQby8lXLIgkxNiIKO4Nd2Qux+0Wo/Vj7eO0zyCbNL4Gs7MXZ3Vq8W2evsJuuNIMfXdjoVZuW9+d38+qU3grQHWdCnO5bXLxSkonq6Y3nTI0EOL351KjxQanmd6R7CS06Q04tfnQqPlM+/7Oa9EaQxxHHQiXYvfh2BIGVHPdLHgNU0mlCxPNLHgDXUDYUU1IuHOJWcDJULo30MWENpaB1UUH9bUHbx/xsb72PAOjoR1IfHgIVwHATgrWdAaEG9mc3riHaI9YZIguxChXV+yyx/MgV5rYaTVbvQwQnCk1W70KEJEkw17EKHJkgwWbULHZogtiAEnqzahQ5OEJ6s2oUOT9AIcRBU64pGAAUBKAhAQQAKAvAsBqAgAAUBKAhAQQAKAlAQwKegzWRytVB+0Nfl1wdu1IXbH59U6+jLDGnHy+nVAM4U18SjoM1+k5tys40PhrrtD/r9fJ1V1y0NcfUyfdpuvl97VbozxZ3hT1A+wF7eXH4w1Jmu3W5Od08McfUyQ9r29nCtr7ghbIo7x5+gxi40PhjqspV2LzeTd9XvNcTVywxpRXHeagxxF3gUdGzexc42PhjqsuWbetdwxkmQPq7xvTHt8N/h3l3gT1D+t1P8HTU+GOpeZ4ert0vNb6p+giGuXmZOO11KN8c1iSyo+Ao1DaEgc9reT62P7l6Q2yGWf3X7cFlXL5IeYua06uCLc4i5ddL5V5qzs6STzi4FqdNWp84pTiftdJrPdxU2DfN5+cyjOq26pwfjmsQeKB73EnbS5pFd7SymTdve1r+NMlA8/pPfw0Z385vTB1i3nEwm6j6j+OUwrl6mTVvldzyvFjiuCSerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4HOQ07WOvdXr4AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,res[<span class="dv">3</span>,],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,res[<span class="dv">4</span>,],<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=15&quot;</span>,<span class="st">&quot;k=25&quot;</span>),<span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,res[<span class="dv">5</span>,],<span class="at">col=</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">legend=</span><span class="st">&quot;k=100&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OmY6ZrY6kNtmAABmOmZmZjpmZmZmZpBmkNtmtv+QOgCQOmaQZjqQZmaQZpCQkGaQttuQ29uQ2/+2ZgC2Zjq2Zma2ZpC2kGa2tra22/+2///bkDrbkGbbtpDb29vb2//b///fU2v/tmb/25D/27b//7b//9v////VFmvdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIHklEQVR4nO2diXoaNxRGcey6TZq0bu2mG9RZIHUdnMD7v1xnM8yQkX4t944u8J/vIwYsrmaONVoHZbYlXmalD8A6FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIICxodjSUEiQbTi9PFUFf37yu/l1X+l8sBcJJYUzQ6vKxfnabH26EzzWxH7IlqFPTaMoMd8DnPjEftCXo6boRtHZcZMmC9mKiFdkSpFOCDpVEObIkqG4fr7bP1XVmuD0jNiIM2RG0bRxdzKuGzOEn6WAdKoIVefP8NN89fbfcvH/1sX6gDwVHjychnNtDoKHnPAe1/PMHK0H/NU82b18tP91u/nhfPR6PSZBXQpCh2S7tmKC/7+f/3tz88nHzeL/8Z769/7l6LNUEbe7afrpYRxEVkpBC5L/EXt5uNw8PD9XT+2Vl5v5mqSho9Vz3HFZC8UOcFnz+AYb8gv76bfnlw4cPj7WgT/PN739WDy1Bm7udFplmPugKgolAJf30Y/f0fvnlp7e/1g/0oeDoB/QGGDIdxaA6GJYhO828dAkK7emAdHYEVXVQV4ScHaGYcOF95aMR1PWlZzNH+YkKFzHe8l9llgQJhosaj3oNmRPUq4oywkXO+3gMmZtyFREUPTEWP5Hmxbqg+InDhKlGH8YFpZytrCHbgtLOVdSQ7VYs8UwlDekJqrpCl4+LrAmz5BM9BkHri3k1zMiack0vCIJFSEtQXf/U47BVxmA14yzlDOnNSd82gg5G8zH9r6xzFDOkXYIW6aP5vFO0Lqirg3bD+vhwmWVAqgiptmKzeuknMVz2CQoZMtsPyj89GUNWBUmcnIgho8s+Mn99u4Kcyz6h4WTqD7OC8ifthZoggTA2l32k2miBOCZLkNxAIT+SyWUfwcF4tiGLyz6iM4JGBeWEk50yzY1mUpBoTpmGtAWt4qc7hAVlGrJXgoSXbbaZxi0Kks3p1ATJ+8krk0qCVlUt095IHtuTVhCUZUipo3gxr7pC9Z3ksYI0/GQZUhxqbO4SVjV0BGUYUh2sLi4fjQhKj6s7WF1cRQrS8mNM0O7CqoZkUYLk+0C90GmfU2vF2otscxcpKCqXGFLdm+oHKfpJNnQ+ghINWRKk6ycx/nkJSsjgnAQlZTCxIN98kLqfpCwMlaBJBOntRqAuaAI/KZmcnaDYXMwImsRPgiErghRHYXkZ2REkG9+N1o4oJyMoMisKAhgRNKGfyGvsDAXFGbIhaFI/cYZMCJqsjU/I0Igg2eAYCgIo7OulOd0xvaBwQxZKUAE/4YbOVlBorkqCFi+W26frsG/7lPETWoR0BDV+vp+HbVVaSFCgIaWbF17X6/L1U3wjeSk/gYbU7u7obmDAX0UoJyjIkNIlVpWeVVgJKugnKHMdQV/fvFg2RWjtqqWtCIK5azXz67Y7eAXDFRUUYKh0P6isnwBD5y4IGlISFPqd1eJ+4CEo3YIX+p1VE4K8x6B7Eydq5g34QYZUbwPeoo6iCUF+QxOXoN100Hc11YE1P6tfFP1ZGXL/XkOQ8Fal6vi2p1RqxSS3Kp0Ct6HS/SArOA1pCpLZqnQiXIYoqMNVD1HQjnFDFLRn1BAF9RgzxFasz0hFpCdIYKvS6ZlQkMBWpSX4pgxpCZLYqrQInw8UaQlybFWaGm5KphEksFVpMQZlSLkOOtyqNPU/P5qW/mWm2orlbFValr0i9oPGoaBQCi/72Kfwso99yi77HAHFln2OBg1BASUoLmhgOtlkkaVceNknLujJCcLLPnFBT0+QcFAKkkl3jIJc80FxQU9YkExQCpJJR0GTJlMU1E7V13cCe2ug0yJaUNOHdn6Z5fSIFdSp8Q81TolYQU/XjSDXYPX0YAkCxAmqx2FX2+fq+iyIXjisVzTAYP6kOJopwFII3x90elAQgIIAFASgIIBkK7bu39Wwdt/i0P/Vvm81wtMPy7HPuJN5ojWLwru/rC/cEEFB9Vehd1+HHrzwpGs2cnBQf8l67DPuZO5om7vq06tnd75wB8gJaq+8dmOG4QtPOt+gbr2fVvGE6yfzRGvHkN1MsS/cIXKCBocweOFJ1+1TMEbVXd+drydcP5knWpe4LTWecN8gKKgp3t3BDl540m0XL/tVwwF7Qe5wg/e90bbt7iww3BA5Qe1fp/sbDV540n19U08LuG673p2CJ1w/mT/afkHYH25IYUHdW6hoBAryR6v89Oro6QWlXWLtW9fjM7jRl5g/2u7iK3OJpVXS7VuO1jmkkt5+K2g82mpfOZWppJOa+fZQYdHwt8sHHsej9e9cLtPMp3UUm6OElbS/Z9drxZzRnq777xbpKDb/wV+d6ebuav8CplvMZjPXGlJz5jBcP5kz2qq9b+dijsMN4YwigIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8B2OjTBSQtbdYAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,res[<span class="dv">6</span>,],<span class="at">col=</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,res[<span class="dv">7</span>,],<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=500&quot;</span>,<span class="st">&quot;k=1000&quot;</span>),<span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#从上述图线中可以发现(1,2)之间均存在零点, 故可以猜想uniroot的搜索区间定为[1,2].</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#为此给出k不同取值时在a=1,2处的值.</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(k[i],<span class="fu">diff</span>(<span class="dv">1</span>,k[i]),<span class="fu">diff</span>(<span class="dv">2</span>,k[i])),<span class="dv">7</span>))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1]  4.0000000  0.0171013 -0.0161301
## [1]  5.0000000  0.0106835 -0.0089009
## [1]  6.0000000  0.0072998 -0.0049887
## [1]  7.0000000  0.0053010 -0.0031258
## [1]  8.0000000  0.0040232 -0.0021197
## [1]  9.0000000  0.0031571 -0.0015223
## [1] 10.0000000  0.0025433 -0.0011415
## [1] 11.0000000  0.0020924 -0.0008851
## [1] 12.0000000  0.0017516 -0.0007050
## [1] 13.0000000  0.0014878 -0.0005739
## [1] 14.0000000  0.0012793 -0.0004757
## [1] 15.0000000  0.0011118 -0.0004004
## [1] 16.0000000  0.0009752 -0.0003414
## [1] 17.0000000  0.0008622 -0.0002944
## [1] 18.0000000  0.0007678 -0.0002564
## [1] 19.0000000  0.0006881 -0.0002252
## [1] 20.0000000  0.0006202 -0.0001993
## [1] 21.0000000  0.0005619 -0.0001776
## [1] 22.0000000  0.0005114 -0.0001592
## [1] 23.0000000  0.0004675 -0.0001435
## [1] 24.0000000  0.0004289 -0.0001300
## [1] 25.0000000  0.0003950 -0.0001184
## [1]  1.00e+02  2.43e-05 -5.90e-06
## [1]  5e+02  1e-06 -2e-07
## [1]  1e+03  2e-07 -1e-07</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#可以看到, 在k不同取值时1,2处符号均相反. 故[1,2]中一定存在根.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>roots<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  roots[i]<span class="ot">&lt;-</span><span class="fu">uniroot</span>(<span class="cf">function</span>(a){<span class="fu">diff</span>(a,k[i])},<span class="at">lower=</span><span class="dv">1</span>,<span class="at">upper=</span><span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(k,<span class="fu">round</span>(roots,<span class="dv">3</span>))))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.534</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.563</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.615</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.649</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.671</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.674</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.677</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.684</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.686</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.721</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.730</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.731</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">##题11.4</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>S<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  tk<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(tk,<span class="at">df=</span>k))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">S</span>(a,k)<span class="sc">-</span><span class="fu">S</span>(a,k<span class="dv">-1</span>))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>roots2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  roots2[i]<span class="ot">&lt;-</span><span class="fu">uniroot</span>(<span class="cf">function</span>(a){<span class="fu">A</span>(a,k[i])},<span class="at">lower=</span><span class="dv">1</span>,<span class="at">upper=</span><span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(k,<span class="fu">round</span>(roots2,<span class="dv">3</span>))))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.534</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.563</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.615</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.649</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.671</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.674</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.677</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.684</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.686</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.721</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.730</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.731</td>
</tr>
</tbody>
</table>
<p>对比可以发现题11.5与题11.4的结果相同.</p>
</div>
<div id="em" class="section level3">
<h3>EM</h3>
<div id="em算法" class="section level4">
<h4>(1) EM算法:</h4>
<p>记满足<span class="math inline">\(I(T_i\leq \tau)=1\)</span>的观察值为<span class="math inline">\(y_1,...,y_{n_1}\)</span>, 则剩余未观测到实际值的<span class="math inline">\(T_i\)</span>有<span class="math inline">\(n-n_1\)</span>个, 其观测值<span class="math inline">\(y_{n_1+1}=...=y_{n}=1\)</span>.记其真实值为<span class="math inline">\(Z_1,...,Z_{n_2}\)</span>. 则基于完整数据<span class="math inline">\(y,z)\)</span>的似然函数: <span class="math display">\[\begin{align*}
L(y,z,\lambda)&amp;=\lambda^{-n} e^{-\frac{1}{\lambda}(\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} z_j)}\\
l(y,z,\lambda)&amp;=-n \ln \lambda- \frac{1}{\lambda} (\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} z_j)
\end{align*}\]</span></p>
<p><strong>E步</strong>: 在第i步迭代完成后, 记此时得到的迭代参数值为<span class="math inline">\(\lambda^{(i)}\)</span>. 则对数似然函数为: <span class="math display">\[
Q(\lambda|\lambda^{(i)})=-n \ln \lambda- \frac{1}{\lambda} (\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} E[z_j|\lambda^{(i)},y])
\]</span> 下面求解<span class="math inline">\(z_j\)</span>的分布: <span class="math display">\[\begin{align*}
P(z_j-\tau\leq u|I(z_j&gt;\tau)=1)&amp;=1-P(z_j &gt; u + \tau |z_j&gt;\tau)\\
&amp;=1-P(z_j &gt; u)=P(z_j\leq u)
\end{align*}\]</span> 其中第二个等号由指数分布的无后效性得到.由此, <span class="math display">\[
z_j-\tau|(\lambda^{(i)},y) \sim Exp(1/\lambda^{(i)})\implies E[z_j|\lambda^{(i)},y] = \tau + \lambda^{(i)}
\]</span> 故 <span class="math display">\[
Q(\lambda|\lambda^{(i)})=-n \ln \lambda- \frac{1}{\lambda}(\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} (\tau + \lambda^{(i)}))
\]</span></p>
<p><strong>M步</strong>：</p>
<p>对上式求导: <span class="math display">\[\begin{align*}
\frac{\partial Q(\lambda|\lambda^{(i)})}{\partial \lambda} &amp;= -\frac{n}{\lambda} + \frac{1}{\lambda^2} (\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} (\tau + \lambda^{(i)}))=0\\
\implies \lambda^{(i+1)}&amp;=\frac{\sum_{j=1}^{n_1} y_j+\sum_{j=1}^{n_2} (\tau + \lambda^{(i)})}{n}=\frac{\sum_{j=1}^{n_1} y_j +n_2(\tau+\lambda^{(i)})}{n}
\end{align*}\]</span></p>
<p>依据上述推导, 迭代程序如下:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>y[y<span class="sc">!=</span><span class="fl">1.00</span>]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span>n<span class="sc">-</span>n1</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">sum</span>(x)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  lambda[i]<span class="ot">&lt;-</span>(s<span class="sc">+</span>(n2<span class="sc">*</span>(lambda[i<span class="dv">-1</span>]<span class="sc">+</span>tau)))<span class="sc">/</span>n</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda[i]<span class="sc">-</span>lambda[i<span class="dv">-1</span>])<span class="sc">&lt;</span><span class="fl">1e-6</span>){</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>name<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;times&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(name,<span class="fu">round</span>(<span class="fu">c</span>(i,lambda[i]),<span class="dv">4</span>)))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">name</td>
<td align="left">times</td>
<td align="left">lambda</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">11</td>
<td align="left">0.9643</td>
</tr>
</tbody>
</table>
<p>事实上, 设<span class="math inline">\(\{\lambda^{(i)}\}_{i\geq 1}\)</span>的收敛值为<span class="math inline">\(\lambda^*\)</span>, 则有 <span class="math display">\[
\lambda^*=\frac{\sum_{j=1}^{n_1} y_j +n_2(\tau+\lambda^*)}{n} \implies \lambda^*=\frac{\sum_{j=1}^{n_1} y_j +n_2\tau}{n_1}
\]</span></p>
<p>代入计算得到<span class="math inline">\(\lambda^*=\)</span> 0.9643, 与迭代结果值一致.</p>
</div>
<div id="mle" class="section level4">
<h4>(2) MLE</h4>
<p><span class="math display">\[
P(y_j &gt;\tau)=\int_{\tau}^{\infty} \frac{1}{\lambda} e^{-\frac{y}{\lambda}} dy= e^{-\frac{\tau}{\lambda}}
\]</span></p>
<p>似然函数: <span class="math display">\[\begin{align*}
L(y,\lambda)&amp;=\prod_{j=1}^{n_1} f(y_j,\lambda) \prod_{j}^{n_2}P(y_j&gt;\tau)\\
&amp;=\lambda^{-n_1} e^{- \frac{1}{\lambda} \sum_{j=1}^{n_2} y_j} e^{-\frac{n_2\tau}{\lambda}}=\lambda^{-n_1} e^{- \frac{1}{\lambda} (\sum_{j=1}^{n_2} y_j + n_2 \tau)}\\
l(y,\lambda) &amp;= -n_1 \ln \lambda  - \frac{1}{\lambda} (\sum_{j=1}^{n_2} y_j + n_2 \tau) 
\end{align*}\]</span> 对上式求导: <span class="math display">\[\begin{align*}
\frac{\partial l(y,\lambda)}{\partial \lambda} &amp;= -\frac{n_1}{\lambda}+\frac{\sum_{j=1}^{n_2} y_j + n_2 \tau}{\lambda^2} =0 \\
\implies \hat{\lambda}_{MLE} &amp;= \frac{\sum_{j=1}^{n_2} y_j + n_2 \tau}{n_1}
\end{align*}\]</span></p>
<p>代入计算, 得到<span class="math inline">\(\hat{\lambda}_{MLE}=\)</span> 0.9643. 事实上与EM得到的结果一致.</p>
</div>
</div>
</div>
</div>
<div id="section-31" class="section level1">
<h1>11-25</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 1 and 5 (page 204, Advanced R)</li>
<li>Excecises 1 and 7 (page 214, Advanced R)</li>
</ul>
<div id="exercises-1-p204" class="section level3">
<h3>Exercises 1 (P204)</h3>
<p>第一种用法把trims作为变量; 第二种用法中, (为避免混淆, 接下来将mean函数写为mean(y, trim).) 把函数mean(y,trim)中y指定为从Cauchy分布中得到的x之后, 函数会识别trims为mean(y,trim)中的trim,</p>
<!-- 即与第一种用法同样成为作用在mean上的泛函. -->
</div>
<div id="exercises-2-p204" class="section level3">
<h3>Exercises 2 (P204)</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for循环</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>lm_for <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>bootstraps[[i]]</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  lm_for[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> x)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>lm_for</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.985       -5.342  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.900       -4.973  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.516       -5.635  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.615       -5.099  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.410       -5.357  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      42.452       -6.975  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##       37.78        -5.53  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      35.885       -5.153  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.140       -5.138  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      41.343       -6.525</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply方法</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>lm_lapply <span class="ot">=</span> <span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> wt, <span class="at">data =</span> x))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>lm_lapply</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.985       -5.342  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.900       -4.973  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.516       -5.635  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      36.615       -5.099  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.410       -5.357  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      42.452       -6.975  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##       37.78        -5.53  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      35.885       -5.153  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      37.140       -5.138  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ wt, data = x)
## 
## Coefficients:
## (Intercept)           wt  
##      41.343       -6.525</code></pre>
</div>
<div id="exercises-1-p214" class="section level3">
<h3>Exercises 1 (P214)</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">25</span>), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(a)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>a_sd <span class="ot">&lt;-</span> <span class="fu">vapply</span>(a, sd, <span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sde=</span><span class="dv">0</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(a_sd,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     V1     V2     V3     V4     V5 
## 11.261 20.988 15.900 10.854 12.438</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## (2)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>a<span class="sc">$</span>V1[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">&#39;a&#39;</span> <span class="co">#将a的v1的第一个分量改为字符</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>isNum <span class="ot">&lt;-</span> <span class="fu">vapply</span>(a, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>)) <span class="co">#第一次vapply判断是否为数值型</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>a_sd <span class="ot">&lt;-</span> <span class="fu">vapply</span>(a[isNum], sd, <span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="dv">0</span>)) <span class="co">#第二次vapply计算sd</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(a_sd,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     V2     V3     V4     V5 
## 20.988 15.900 10.854 12.438</code></pre>
</div>
<div id="exercises-7-p214" class="section level3">
<h3>exercises 7 (P214)</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">&lt;-</span><span class="cf">function</span>(x,f,<span class="at">num=</span><span class="dv">4</span>){</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(num) <span class="co">#num为核的数量</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span>  <span class="fu">parSapply</span>(cl,x,f)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mcsapply</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">30</span>,<span class="dv">2</span>), sqrt, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.732051 2.236068 2.645751 3.000000 3.316625 3.605551 3.872983
##  [9] 4.123106 4.358899 4.582576 4.795832 5.000000 5.196152 5.385165</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mcvapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x, f, f.value, <span class="at">num=</span><span class="dv">4</span>) {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(num) <span class="co">#num为核的数量</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    out_list <span class="ot">&lt;-</span>  <span class="fu">parSapply</span>(cl,x,f)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(f.value, <span class="fu">length</span>(x)), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> out_list[[i]]</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stopifnot</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(res) <span class="sc">==</span> <span class="fu">length</span>(f.value),</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">typeof</span>(res) <span class="sc">==</span> <span class="fu">typeof</span>(f.value)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>      out[i, ] <span class="ot">&lt;-</span> res</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>      out</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mcvapply</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">30</span>,<span class="dv">2</span>), sqrt,<span class="fu">numeric</span>(<span class="dv">1</span>), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##           [,1]
##  [1,] 1.000000
##  [2,] 1.732051
##  [3,] 2.236068
##  [4,] 2.645751
##  [5,] 3.000000
##  [6,] 3.316625
##  [7,] 3.605551
##  [8,] 3.872983
##  [9,] 4.123106
## [10,] 4.358899
## [11,] 4.582576
## [12,] 4.795832
## [13,] 5.000000
## [14,] 5.196152
## [15,] 5.385165</code></pre>
</div>
</div>
</div>
<div id="section-32" class="section level1">
<h1>12-02</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ul>
<li>Write an Rcpp function for Exercise 9.8 (page 278, StatisticalComputing with R).</li>
<li>Compare the corresponding generated random numbers withpure R language using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with thefunction “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp) </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(int N, int thin, int n, int a, int b) {</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="st">  double x = 10, y = 0.5; </span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i = 0; i &lt; N; i++) {</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="st">    for(int j = 0; j &lt; thin; j++) {</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="st">      x = rbinom(1, n, y)[0];</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="st">      y = rbeta(1, x + a, n - x + b)[0];</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 0) = x;</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 1) = y;</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin, n, a, b) {</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span><span class="dv">10</span>; y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co">#初值选为x = 10, y = 0.5</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">5</span>;n <span class="ot">&lt;-</span> <span class="dv">20</span>;N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#a,b,n,分别选为5,5,20; 生成数据总数为1000对</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>time<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  gibC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(N, <span class="dv">10</span>, n, a, b),</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  gibR <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(N, <span class="dv">10</span>, n, a, b)</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibC[,<span class="dv">1</span>], gibR[,<span class="dv">1</span>])</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibC[,<span class="dv">2</span>],gibR[,<span class="dv">2</span>])</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6Ojo6ZrY6kNtmAABmkJBmtv+QOgCQZgCQkGaQ2/+2ZgC2Zjq2tma2/7a2///bkDrbkJDb////tmb/trb/25D//7b//9v///8DUi41AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAImElEQVR4nO2djValNhRG0dG2Wm29bYcOdeT9H7OQECSQ8OWfIN9eS0dnzk0ue5KQcE+g6ckuzdFvoHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgsaDmNBwlKG1xGZjcUJCFRnyxBdlo1HcKMiMaUENBVmTvoiA7qvVQ0IapZ7EFWZhHn56DtAl1ele/UNCKZhp91PhDQSvm+TNn0kY2CzAKmpnUUNCa2Yr8Qf7d5786F5P4XaUtLpzPWY/Usx55ri5IaVGGKEhn1jJPnZvVuf3SgprF0KP9vIxxLizxe0tbXBCale0JfgpyLi3xe0pSXKL3YrXTX7kFOV6Xv6wg188trirI+XOdiwpy/9zrmoI8zhVXFOTefPpLCvLy4yvo53Oz5P578LsMfWE0fn78Bb0s/q47nyDt/9fpBc4li+8nF9R4+7nUGNQE+PEX1A5Fi1bUhjcfn3rTEaLHX1B79zb0s4f+fIKC9HgL+nh9Et+//TiboEA/oYP07duPcwkK9RPWggZuD7uCbsM/vj82zdAhI+tNQrCegDFo0jLMGHcECT+/vK2nBSH1JiDcTh90FpOH/PFqF/Tz+WlsYyJ8GK2i6o0nyk+eedDYbqbOaJtLFhMU0bvk65MHjoytp62hBYXNfbQSkgeO/Hy+/y6aUGcbpcsIiveTbanRyff0kKi4IJoEfr7yWiyFni8sKI2eGEHtzjRwEXXQWSyVn6/5yWqSwUeVlTzwkOL0stPp+YpXFFM2nz6boI9X+fasAdkEpdWT61ONtpkW/Z36IbhePxI3nz7TGDRfFCm81EivJ0rQvzur+bkjllys5vATdNFeHPPe5Y5jWlAGO72/oHH1eRsOelhrWUaXEXXRqOQYlMeP/yXXB9GDWjCLVoO5pf1kEJRHT8BZ7Gm09Kt9mZ66XsficvkJmwfd9rpX4nrdSsulJ1SQteekr9epsGx6QgXFdrBsglKWOpXtF1ihoIzdSxTvF1idoHyjs6rAL3C5Fqvho+fsfs59PSjH0mJTR/LAcsWV8BMkSPSzyDN9/PE0RfyECOrEQqt1uGKfol5rAWX8BAhSS/W42WL0peIidvoQQepiT8QFaZ96za8upSesBclZkO1KT+J6Ta8t6CdsDBr7mDUtIXG9hpcW1FN8opjgyMr6OeE8qKyf0wkq3H7OJqi0nT7kkus8DJU/zR/g50wtqHjvkrUmD8xUXNHJz7Je78DFmd6SJJ60XhV/kJ+IiWLzIj4Dyl2vjD7MT9xSI2K14XWQh9npIxerZRKojms9onbvQHW5o43aEeV+oMf6iRqDVGfLWe/BeiIuuQ6N5xYxVXSs92g9lc+DDm8+fTZBcG+0S3EV6MklCO+NdiiuCj85kzh390bj4qrQk0mQw95oWFwlfjKnAdv3RoPiatGTbQyCe6P3i6tGT8azGNgbvVtcRX5qnAfV073Eu0keGFWcPjWswE92QX6DdH1+Sreg/YOv0E9NXaxGPTUJUl7q8pNLkP+OwyqbT59toui/41Dce786PbmXGq77xbTu5VFRAbIuVnu047BZPihm/l4Vh7agRn6JPyrsXYJcY5DLjsOp1UhHlfrJdRZz2nEov9RzGur0c+Q8aBp/ts/6qIojBal+Ng/WNXKooFq71ZIjlxpzN6uZQ9di9befg1tQ/XoOFHQaDhIUXZPbh/sJKyxTSrqaKChFFAWVK6pQKelqoqAUURRUrqhCpaSriYJSRH1NQSeFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAbIL6hZPehEpjsbEmW71PBjjndS0oPFJgsa9tVrUvAMwmNyCxjtaqbtafbwOP7Smw1pGid9NCTZaUDcEyL19e1HjDsAuzlBmQTIpbbpJ7PujuBHhNntPi+pFGtJWkBYkf0FFyf3bcbeozSzI4MRwl7R1VPvtj60gLUg8ihJWeAZB4kC0lE/DrvNV1PCrYQzSgrr7f56Nw5leVP1dTDYXfXjZHpYeNfYSgyAtqB1z2U13QFhVuB78/SktqLON0Z9RYwYtFHS3aZmmouSDc6Pu1F+4i5nTY7Uo8QvqYnKQkQPOTlG2s4IHZQfp1jwL0qLaKT9lfexakDRgGKr1qE0H96fkaf4zz3o3asTQgrQgmfRv6GKGecWRd6fFLOdt9tFgPVE0zqT1KeAQsMj8t0TVPwbND5UczzhT5zG1+EWUwLjU0II626pFi7rZopzhYhVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlQmaMzaWGb9iMTh8XP698dFXueUTjz8EZk+5kBlgkYWgmS+1W3QoFtT6cSRj811oWpB00/jkzyWgj6TpC4k6NY0d3/evcku9vujTFpR9/v877sh226TU5SHSgSNmU5dowSJLvWkZbFuBd2u1ILk4d+UoCmLfvmwxY0gMTxdRpBMI+yUoBf1i12QTCe+jKBWEyRyV4fvO11sSie+jCBzC5oH6a550QWpdOLLCJpO3NoYNMixnOYXt22+iqDtWUxuQRE9ScwL9XmQGpuuI2icB93/PZ641DxI+hA3sJZLjZfPZ+XO6cQXEjSylxIvWtD7b+tXXEWQOPzdZ0yLiG4dcBlBIm9+d+ObWM3/peu46mq+LigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQ4H+TlrDet6G31AAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time)</span></code></pre></div>
<pre><code>##                             expr       min        lq       mean     median
## 1 gibC &lt;- gibbsC(N, 10, n, a, b)  4.497501  4.720702   8.233978   6.371601
## 2 gibR &lt;- gibbsR(N, 10, n, a, b) 59.974600 64.324351 105.998751 101.984701
##         uq      max neval
## 1  10.7977  18.5827   100
## 2 132.6080 311.3846   100</code></pre>
<p>通过qq图的对比, 点基本落在对角线附近或均匀分布在两侧, 可以发现gibbsR和gibbsC的随机数生成结果非常相似. 从耗时的对比来看, C++的生成速度是R的10多倍, 明显有更高的效率.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
